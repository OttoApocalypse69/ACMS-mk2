<UserControl x:Class="PixelArtEditor.UI.Views.ToolbarView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:local="clr-namespace:PixelArtEditor.UI"
             mc:Ignorable="d"
             d:DesignHeight="450" d:DesignWidth="50">
    
    <Grid Background="#252526">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Undo/Redo -->
            <RowDefinition Height="*"/>    <!-- Tools -->
            <RowDefinition Height="Auto"/> <!-- Pencil size -->
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,6">
            <Button Command="{Binding UndoCommand}" Width="26" Height="26" Margin="2"
                    Background="#252933" BorderBrush="#3A3F47" BorderThickness="1" ToolTip="Undo">
                <Path Data="M15,8 L9,8 L9,4 L3,10 L9,16 L9,12 L15,12 Z"
                      Fill="#E0E4FF" Stretch="Uniform"/>
            </Button>
            <Button Command="{Binding RedoCommand}" Width="26" Height="26" Margin="2"
                    Background="#252933" BorderBrush="#3A3F47" BorderThickness="1" ToolTip="Redo">
                <Path Data="M9,8 L15,8 L15,4 L21,10 L15,16 L15,12 L9,12 Z"
                      Fill="#E0E4FF" Stretch="Uniform"/>
            </Button>
        </StackPanel>

        <ListBox Grid.Row="1" ItemsSource="{Binding Tools}" SelectedItem="{Binding ActiveTool}" Background="Transparent" BorderThickness="0" HorizontalContentAlignment="Center">
            <ListBox.Resources>
                <Style x:Key="ToolIconStyle" TargetType="Path">
                    <Setter Property="Fill" Value="#E0E4FF"/>
                    <Setter Property="Stretch" Value="Uniform"/>
                    <Setter Property="Width" Value="20"/>
                    <Setter Property="Height" Value="20"/>
                    <Setter Property="HorizontalAlignment" Value="Center"/>
                    <Setter Property="VerticalAlignment" Value="Center"/>
                </Style>
            </ListBox.Resources>
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Border Background="#252933" CornerRadius="8" Margin="4" Padding="6" Width="40" Height="40" ToolTip="{Binding Name}">
                        <ContentControl>
                            <ContentControl.Style>
                                <Style TargetType="ContentControl">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Name}" Value="Pencil">
                                            <Setter Property="Content">
                                                <Setter.Value>
                                                    <Path Data="{StaticResource PencilIcon}" Style="{StaticResource ToolIconStyle}"/>
                                                </Setter.Value>
                                            </Setter>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Name}" Value="Eraser">
                                            <Setter Property="Content">
                                                <Setter.Value>
                                                    <Path Data="{StaticResource EraserIcon}" Style="{StaticResource ToolIconStyle}"/>
                                                </Setter.Value>
                                            </Setter>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Name}" Value="Eyedropper">
                                            <Setter Property="Content">
                                                <Setter.Value>
                                                    <Path Data="{StaticResource EyedropperIcon}" Style="{StaticResource ToolIconStyle}"/>
                                                </Setter.Value>
                                            </Setter>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Name}" Value="Fill">
                                            <Setter Property="Content">
                                                <Setter.Value>
                                                    <Path Data="{StaticResource FillIcon}" Style="{StaticResource ToolIconStyle}"/>
                                                </Setter.Value>
                                            </Setter>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Name}" Value="Rectangle Select">
                                            <Setter Property="Content">
                                                <Setter.Value>
                                                    <Path Data="{StaticResource SelectIcon}" Style="{StaticResource ToolIconStyle}"/>
                                                </Setter.Value>
                                            </Setter>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Name}" Value="Line">
                                            <Setter Property="Content">
                                                <Setter.Value>
                                                    <Path Data="{StaticResource LineIcon}" Style="{StaticResource ToolIconStyle}"/>
                                                </Setter.Value>
                                            </Setter>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Name}" Value="Rectangle">
                                            <Setter Property="Content">
                                                <Setter.Value>
                                                    <Path Data="{StaticResource RectangleIcon}" Style="{StaticResource ToolIconStyle}"/>
                                                </Setter.Value>
                                            </Setter>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ContentControl.Style>
                        </ContentControl>
                    </Border>
                </DataTemplate>
            </ListBox.ItemTemplate>
            <ListBox.ItemContainerStyle>
                <Style TargetType="ListBoxItem">
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ListBoxItem">
                                <Border Background="{TemplateBinding Background}" BorderThickness="0" Padding="1">
                                    <ContentPresenter/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="#007ACC"/>
                                    </Trigger>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#3E3E42"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </ListBox.ItemContainerStyle>
        </ListBox>

        <!-- Pencil size selector -->
        <StackPanel Grid.Row="2" Margin="4,8" HorizontalAlignment="Center">
            <TextBlock Text="Pencil Size" Foreground="#AAAAAA" FontSize="10" HorizontalAlignment="Center" Margin="0,0,0,2"/>
            <ComboBox Width="60"
                      SelectedValue="{Binding PencilSize, Mode=TwoWay}"
                      SelectedValuePath="Tag"
                      Background="#252933" Foreground="#E0E4FF"
                      BorderBrush="#3A3F47" BorderThickness="1">
                <ComboBoxItem Content="1 px" Tag="1"/>
                <ComboBoxItem Content="2 px" Tag="2"/>
                <ComboBoxItem Content="3 px" Tag="3"/>
                <ComboBoxItem Content="4 px" Tag="4"/>
            </ComboBox>
        </StackPanel>
    </Grid>
</UserControl>
